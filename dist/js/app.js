let App=function(){let t={State:{options:{listView:!1},data:{items:[],alert:"No data available, please try with different search parameters.",cart:[],totalPrice:0,quantity:0},params:{page:1,per_page:9,beer_name:null,abv_gt:null,abv_lt:null,brewed_before:null,brewed_after:null,food:null}},DOM:{ul:document.querySelector(".products__list"),templateTile:document.getElementById("items-template-tile"),templateList:document.getElementById("items-template-list"),templateModal:document.getElementById("template-modal"),templateAlert:document.getElementById("no-data-alert"),templateCartItem:document.getElementById("template-cart-item"),tileBtn:document.querySelector(".tile-view"),listBtn:document.querySelector(".list-view"),nameInput:document.querySelector("#name"),alcRange:document.getElementById("amount"),brewedBefore:document.getElementById("brewed-before"),brewedAfter:document.getElementById("brewed-after"),food:document.querySelectorAll("ul.food li"),clearAll:document.getElementById("clear-all"),modal:document.getElementById("modal"),burger:document.getElementById("burger"),cart:document.querySelector(".cart"),removeFromCartBtns:document.querySelectorAll("#remove"),addToCartBtns:document.querySelectorAll(".btn__add-to-cart"),subtotal:document.getElementById("subtotal"),templateCheckout:document.getElementById("template-checkout"),checkout:document.querySelector(".checkout")},Events:{modalAddToCart:function(){t.DOM.modal.addEventListener("click",function(e){if(e.target.classList.contains("trigger")){let a=parseInt(e.target.dataset.id);axios.get(`https://api.punkapi.com/v2/beers/${a}`).then(e=>{let a=e.data[0],n=!1;t.State.data.cart.forEach(t=>{t.id===a.id&&(n=!0)}),n?t.State.data.cart.forEach(t=>{t.id===a.id&&(t.quantity+=1)}):(a.quantity=1,t.State.data.cart.push(a)),localStorage.setItem("items",JSON.stringify(t.State.data.cart)),t.Methods.updateCartTotal(),null!==localStorage.getItem("items")&&(t.State.data.cart=JSON.parse(localStorage.getItem("items")),$(".checkout").show(),$(".empty-cart").hide(),t.DOM.cart.innerHTML=Handlebars.compile(t.DOM.templateCartItem.innerHTML)(t.State.data),t.DOM.checkout.innerHTML=Handlebars.compile(t.DOM.templateCheckout.innerHTML)(t.State.data))}),document.querySelector(".modal-wrapper").classList.toggle("open"),document.querySelector(".page-wrapper").classList.toggle("blur-it"),document.querySelector("body").classList.toggle("scroll"),modal.innerHTML=""}})},inputOnChange:function(){t.DOM.cart.addEventListener("change",function(e){if("quantity"===e.target.id){let a=parseInt(e.target.value),n=parseInt(e.target.dataset.id);t.State.data.cart.forEach(t=>{t.id===n&&(t.quantity=a)}),localStorage.setItem("items",JSON.stringify(t.State.data.cart)),t.Methods.updateCartTotal(),t.DOM.cart.innerHTML=Handlebars.compile(t.DOM.templateCartItem.innerHTML)(t.State.data)}})},addToCart:function(){t.DOM.ul.addEventListener("click",function(e){if(e.target.classList.contains("btn__add-to-cart")||e.target.classList.contains("btn__add-to-cart-list")){let a=parseInt(e.target.dataset.id);axios.get(`https://api.punkapi.com/v2/beers/${a}`).then(e=>{let a=e.data[0],n=!1;t.State.data.cart.forEach(t=>{t.id===a.id&&(n=!0)}),n?t.State.data.cart.forEach(t=>{t.id===a.id&&(t.quantity+=1)}):(a.quantity=1,t.State.data.cart.push(a)),localStorage.setItem("items",JSON.stringify(t.State.data.cart)),t.Methods.updateCartTotal(),t.Methods.reRenderCart()}),t.Events.addScrollToCart()}})},addScrollToCart:function(){t.State.data.cart.length>=4&&t.DOM.cart.classList.add("cart-scroll")},removeFromCart:function(){t.DOM.cart.addEventListener("click",e=>{e.target.classList.contains("fa-times")&&(t.State.data.cart.forEach((a,n)=>{a.id==e.target.dataset.id&&(t.State.data.totalPrice-=Math.ceil(a.attenuation_level)*a.quantity,$("#checkout").text(`${t.State.data.totalPrice}`),t.State.data.cart.splice(n,1))}),localStorage.setItem("items",JSON.stringify(t.State.data.cart)),0===t.State.data.cart.length?(localStorage.clear(),setTimeout(()=>{$(".empty-cart").show()},1500),$(".checkout").hide(),this.removeItemUI(e),t.DOM.checkout.innerHTML=Handlebars.compile(t.DOM.templateCheckout.innerHTML)(t.State.data)):(this.removeItemUI(e),t.Methods.updateCartTotal(),t.DOM.checkout.innerHTML=Handlebars.compile(t.DOM.templateCheckout.innerHTML)(t.State.data)),t.State.data.cart.length<=4&&t.DOM.cart.classList.remove("cart-scroll"))})},removeItemUI:function(t){t.target.parentElement.parentElement.classList.add("overlay"),t.target.parentElement.parentElement.classList.add("overlay-spinner"),setTimeout(()=>{t.target.parentElement.parentElement.classList.add("overlay-hidden")},1e3),setTimeout(()=>{t.target.parentElement.parentElement.remove()},1500)},initPagination:function(){var e={totalPages:37,visiblePages:5,startPage:1,next:">",prev:"<",first:"<<",last:">>",initiateStartPageClick:!1,hideOnlyOnePage:!0,onPageClick:function(e,a){t.State.params.page=a,t.State.options.listView?t.Methods.listViewRender():t.Methods.render()}};$("#pagination").twbsPagination(e)},sortByAlcoholRange:function(){$("#slider-range").slider({range:!0,min:0,max:50,values:[0,50],change:function(e,a){$("#amount").val(a.values[0]+"% - "+a.values[1]+"%"),t.Methods.sortByAlcohol()}}),$("#amount").val($("#slider-range").slider("values",0)+"% - "+$("#slider-range").slider("values",1)+"%"),$(".ui-slider-handle").css({"background-color":"#bf431f",outline:"none"})},listBtnOnClick:function(){t.DOM.listBtn.addEventListener("click",function(){t.Methods.listViewRender()}),t.State.options.listView=!0},tileBtnOnClick:function(){t.DOM.tileBtn.addEventListener("click",function(){t.Methods.render()}),t.State.options.listView=!1},nameInput:function(){t.DOM.nameInput.addEventListener("keyup",e=>{const a=e.target.value;t.State.params.beer_name=""!=a?a:null,t.State.options.listView?t.Methods.listViewRender():t.Methods.render()})},dateInputBefore:function(){t.DOM.brewedBefore.addEventListener("change",function(){let e=new Date(t.DOM.brewedBefore.value),a=`${String(e.getUTCMonth()+1)}-${String(e.getUTCFullYear())}`;t.State.params.brewed_before="NaN-NaN"!=a?a:null,t.State.options.listView?t.Methods.listViewRender():t.Methods.render()})},dateInputAfter:function(){t.DOM.brewedAfter.addEventListener("change",function(){let e=new Date(t.DOM.brewedAfter.value),a=`${String(e.getUTCMonth()+1)}-${String(e.getUTCFullYear())}`;t.State.params.brewed_after="NaN-NaN"!=a?a:null,t.State.options.listView?t.Methods.listViewRender():t.Methods.render()})},pickFood:function(){t.DOM.food.forEach(e=>e.addEventListener("click",function(e){e.target.classList.contains("picker")&&(t.State.params.food=this.children[0].defaultValue,t.State.params.page=1,t.State.options.listView?t.Methods.listViewRender():t.Methods.render())}))},modalOpenEvent:function(){t.DOM.ul.addEventListener("click",function(e){if(e.target.parentElement.classList.contains("product__img")||e.target.parentElement.classList.contains("product__img-list")){let a=e.target.parentElement.dataset.id;axios.get(`https://api.punkapi.com/v2/beers/${a}`).then(e=>{t.State.data.items=e.data,t.DOM.modal.innerHTML=Handlebars.compile(t.DOM.templateModal.innerHTML)(t.State.data)}),document.querySelector(".modal-wrapper").classList.toggle("open"),document.querySelector(".page-wrapper").classList.toggle("blur-it"),document.querySelector("body").classList.toggle("scroll")}})},modalCloseEvent:function(){t.DOM.modal.addEventListener("click",function(t){(t.target.classList.contains("modal-wrapper")||t.target.classList.contains("fa"))&&(document.querySelector(".modal-wrapper").classList.toggle("open"),document.querySelector(".page-wrapper").classList.toggle("blur-it"),document.querySelector("body").classList.toggle("scroll"),modal.innerHTML="")})},burgerClick:function(){t.DOM.burger.addEventListener("click",function(){this.classList.toggle("open")})},clearAll:function(){t.DOM.clearAll.addEventListener("click",function(){t.State.params={page:1,per_page:9,beer_name:null,abv_gt:null,abv_lt:null,brewed_before:null,brewed_after:null,food:null},t.DOM.nameInput.value="",t.DOM.alcRange.value="",t.DOM.brewedBefore.value="",t.DOM.brewedAfter.value="",t.DOM.food.forEach(t=>{t.children[0].checked=!1}),$("#pagination").twbsPagination("destroy"),t.Events.initPagination(),$("#slider-range").slider({range:!0,min:0,max:50,values:[0,50]}),$("#amount").val($("#slider-range").slider("values",0)+"% - "+$("#slider-range").slider("values",1)+"%"),t.State.options.listView?t.Methods.listViewRender():t.Methods.render()})}},Methods:{reRenderCart:function(){null!==localStorage.getItem("items")&&(t.State.data.cart=JSON.parse(localStorage.getItem("items")),$(".checkout").show(),$(".empty-cart").hide(),t.DOM.cart.innerHTML=Handlebars.compile(t.DOM.templateCartItem.innerHTML)(t.State.data),t.DOM.checkout.innerHTML=Handlebars.compile(t.DOM.templateCheckout.innerHTML)(t.State.data))},getItems:function(){return document.querySelector("#spinner").className="",axios.get("https://api.punkapi.com/v2/beers",{params:t.State.params}).then(t=>{return document.querySelector("#spinner").className="hidden-spinner",t.data}).catch(e=>{t.DOM.ul.innerHTML="<h4>Unexpected error has occurred!</h4>"})},renderCart:function(){null!==localStorage.getItem("items")&&(t.State.data.cart=JSON.parse(localStorage.getItem("items")),t.DOM.cart.innerHTML=Handlebars.compile(t.DOM.templateCartItem.innerHTML)(t.State.data),t.DOM.checkout.innerHTML=Handlebars.compile(t.DOM.templateCheckout.innerHTML)(t.State.data))},updateCartTotal:function(){let e=0;t.State.data.cart.forEach(t=>e+=Math.ceil(t.attenuation_level)*t.quantity),t.State.data.totalPrice=e,$("#subtotal").text(`${t.State.data.totalPrice}`)},render:function(){this.getItems().then(e=>{t.State.data.items=e,0==e.length?t.DOM.ul.innerHTML=Handlebars.compile(t.DOM.templateAlert.innerHTML)(t.State.data):t.DOM.ul.innerHTML=Handlebars.compile(t.DOM.templateTile.innerHTML)(t.State.data)}),t.State.options.listView=!1},listViewRender:function(){this.getItems().then(e=>{t.State.data.items=e,0==e.length?t.DOM.ul.innerHTML=Handlebars.compile(t.DOM.templateAlert.innerHTML)(t.State.data):t.DOM.ul.innerHTML=Handlebars.compile(t.DOM.templateList.innerHTML)(t.State.data)}),t.State.options.listView=!0},sortByAlcohol:function(){const e=t.DOM.alcRange.value.split(" - ").map(t=>{return parseInt(t.replace(/[^a-zA-Z0-9 ]/g,""))});let[a,n]=e;t.State.params.abv_gt=a,t.State.params.abv_lt=n,t.State.options.listView?t.Methods.listViewRender():t.Methods.render()}}};return{init:function(){t.Methods.render(),t.Methods.renderCart(),t.Methods.updateCartTotal(),t.Methods.reRenderCart(),t.Events.addScrollToCart(),t.Events.burgerClick(),t.Events.initPagination(),t.Events.nameInput(),t.Events.sortByAlcoholRange(),t.Events.listBtnOnClick(),t.Events.tileBtnOnClick(),t.Events.dateInputBefore(),t.Events.dateInputAfter(),t.Events.pickFood(),t.Events.clearAll(),t.Events.modalOpenEvent(),t.Events.modalCloseEvent(),t.Events.addToCart(),t.Events.removeFromCart(),t.Events.inputOnChange(),t.Events.modalAddToCart()}}}();App.init();